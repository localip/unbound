"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(exports,{data:()=>f,initialize:()=>g,shutdown:()=>h});const a=require("../../modules/webpack/common"),b=require("../../modules/webpack/stores"),c=require("../../../common/utilities/index"),d=require("../../modules/patcher/index"),e=(0,d.create)("unbound-experiments"),f={name:"Experiments",id:"dev.experiments",default:!1,restart:!0,wait:!1,cancelled:!1};async function g(){f.cancelled=!1;let d=a.Dispatcher._orderedActionHandlers;for(;!d.CONNECTION_OPEN;)await (0,c.sleep)(10);if(f.cancelled)return;let g=d.CONNECTION_OPEN,h=e.after(b.Users,"getCurrentUser",(b,c,d)=>{if(d)return new Proxy({},{get(b,c){return"hasFlag"===c?function(b){return b===a.Constants.UserFlags.STAFF||d.hasFlag.call(this,b)}:d[c]}})}),i=g.find(a=>"ExperimentStore"===a.name);i&&i.actionHandler({type:"CONNECTION_OPEN",guildExperiments:[],experiments:[],user:{...b.Users.getCurrentUser(),flags:1}});let j=g.find(a=>"DeveloperExperimentStore"===a.name);j&&j.actionHandler(),h()}function h(){f.cancelled=!0,e.unpatchAll()}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jbGllbnQvY29yZS9idWlsdGlucy9leHBlcmltZW50cy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb25zdGFudHMsIERpc3BhdGNoZXIgfSBmcm9tICdAd2VicGFjay9jb21tb24nO1xyXG5pbXBvcnQgeyBVc2VycyB9IGZyb20gJ0B3ZWJwYWNrL3N0b3Jlcyc7XHJcbmltcG9ydCB7IHNsZWVwIH0gZnJvbSAnQHV0aWxpdGllcyc7XHJcbmltcG9ydCB7IGNyZWF0ZSB9IGZyb20gJ0BwYXRjaGVyJztcclxuXHJcbmNvbnN0IFBhdGNoZXIgPSBjcmVhdGUoJ3VuYm91bmQtZXhwZXJpbWVudHMnKTtcclxuXHJcbmV4cG9ydCBjb25zdCBkYXRhID0ge1xyXG4gICBuYW1lOiAnRXhwZXJpbWVudHMnLFxyXG4gICBpZDogJ2Rldi5leHBlcmltZW50cycsXHJcbiAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICByZXN0YXJ0OiB0cnVlLFxyXG4gICB3YWl0OiBmYWxzZSxcclxuXHJcbiAgIGNhbmNlbGxlZDogZmFsc2VcclxufTtcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0aWFsaXplKCkge1xyXG4gICBkYXRhLmNhbmNlbGxlZCA9IGZhbHNlO1xyXG5cclxuICAgLy8gV2FpdCBmb3IgZGlzcGF0Y2hlciBoYW5kbGVyc1xyXG4gICBjb25zdCBldmVudHMgPSBEaXNwYXRjaGVyLl9vcmRlcmVkQWN0aW9uSGFuZGxlcnM7XHJcbiAgIHdoaWxlICghZXZlbnRzLkNPTk5FQ1RJT05fT1BFTikgYXdhaXQgc2xlZXAoMTApO1xyXG5cclxuICAgLy8gRG9uJ3QgcnVuIGNvZGUgYmxvY2sgaW5jYXNlIGV4cGVyaW1lbnRzIGlzIHRvZ2dsZWQgYmVmb3JlIHRoZSBhYm92ZSByZXNvbHZlc1xyXG4gICBpZiAoZGF0YS5jYW5jZWxsZWQpIHJldHVybjtcclxuXHJcbiAgIC8vIEdyYWIgaGFuZGxlcnMgZm9yIENPTk5FQ1RJT05fT1BFTlxyXG4gICBjb25zdCBIYW5kbGVycyA9IGV2ZW50c1snQ09OTkVDVElPTl9PUEVOJ107XHJcblxyXG4gICAvLyBTcG9vZiB0aGUgc3RhZmYgZmxhZ1xyXG4gICBjb25zdCB1bnBhdGNoID0gUGF0Y2hlci5hZnRlcihVc2VycywgJ2dldEN1cnJlbnRVc2VyJywgKF8sIF9fLCByZXMpID0+IHtcclxuICAgICAgaWYgKCFyZXMpIHJldHVybjtcclxuXHJcbiAgICAgIHJldHVybiBuZXcgUHJveHkoe30sIHtcclxuICAgICAgICAgZ2V0KF8sIHByb3ApIHtcclxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdoYXNGbGFnJykge1xyXG4gICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGZsYWcpIHtcclxuICAgICAgICAgICAgICAgICAgaWYgKGZsYWcgPT09IENvbnN0YW50cy5Vc2VyRmxhZ3MuU1RBRkYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuaGFzRmxhZy5jYWxsKHRoaXMsIGZsYWcpO1xyXG4gICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVzW3Byb3BdO1xyXG4gICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICB9KTtcclxuXHJcbiAgIC8vIENhbGwgdGhlIGRpc3BhdGNoZXIgYWN0aW9uIGhhbmRsZXIgd2l0aCB0aGUgc3Bvb2ZlZCBmbGFncyB0byBpbnRlcm5hbGx5IGFsbG93IGJ1Y2tldCBvdmVycmlkZXNcclxuICAgY29uc3QgRXhwZXJpbWVudFN0b3JlID0gSGFuZGxlcnMuZmluZChoID0+IGgubmFtZSA9PT0gJ0V4cGVyaW1lbnRTdG9yZScpO1xyXG4gICBpZiAoRXhwZXJpbWVudFN0b3JlKSBFeHBlcmltZW50U3RvcmUuYWN0aW9uSGFuZGxlcih7XHJcbiAgICAgIHR5cGU6ICdDT05ORUNUSU9OX09QRU4nLFxyXG4gICAgICBndWlsZEV4cGVyaW1lbnRzOiBbXSxcclxuICAgICAgZXhwZXJpbWVudHM6IFtdLFxyXG4gICAgICB1c2VyOiB7XHJcbiAgICAgICAgIC4uLlVzZXJzLmdldEN1cnJlbnRVc2VyKCksXHJcbiAgICAgICAgIGZsYWdzOiAxLFxyXG4gICAgICB9XHJcbiAgIH0pO1xyXG5cclxuICAgLy8gQ2FsbCB0aGUgZGlzcGF0Y2hlciBhY3Rpb24gaGFuZGxlciB0byB1cGRhdGUgaXNEZXZlbG9wZXIgaW50ZXJuYWxseVxyXG4gICBjb25zdCBEZXZlbG9wZXJFeHBlcmltZW50U3RvcmUgPSBIYW5kbGVycy5maW5kKGggPT4gaC5uYW1lID09PSAnRGV2ZWxvcGVyRXhwZXJpbWVudFN0b3JlJyk7XHJcbiAgIGlmIChEZXZlbG9wZXJFeHBlcmltZW50U3RvcmUpIERldmVsb3BlckV4cGVyaW1lbnRTdG9yZS5hY3Rpb25IYW5kbGVyKCk7XHJcblxyXG4gICB1bnBhdGNoKCk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzaHV0ZG93bigpIHtcclxuICAgZGF0YS5jYW5jZWxsZWQgPSB0cnVlO1xyXG4gICBQYXRjaGVyLnVucGF0Y2hBbGwoKTtcclxufSJdLCJuYW1lcyI6WyJkYXRhIiwiaW5pdGlhbGl6ZSIsInNodXRkb3duIiwiUGF0Y2hlciIsImNyZWF0ZSIsIm5hbWUiLCJpZCIsImRlZmF1bHQiLCJyZXN0YXJ0Iiwid2FpdCIsImNhbmNlbGxlZCIsImV2ZW50cyIsIkRpc3BhdGNoZXIiLCJfb3JkZXJlZEFjdGlvbkhhbmRsZXJzIiwiQ09OTkVDVElPTl9PUEVOIiwic2xlZXAiLCJIYW5kbGVycyIsInVucGF0Y2giLCJhZnRlciIsIlVzZXJzIiwiXyIsIl9fIiwicmVzIiwiUHJveHkiLCJnZXQiLCJwcm9wIiwiZmxhZyIsIkNvbnN0YW50cyIsIlVzZXJGbGFncyIsIlNUQUZGIiwiaGFzRmxhZyIsImNhbGwiLCJFeHBlcmltZW50U3RvcmUiLCJmaW5kIiwiaCIsImFjdGlvbkhhbmRsZXIiLCJ0eXBlIiwiZ3VpbGRFeHBlcmltZW50cyIsImV4cGVyaW1lbnRzIiwidXNlciIsImdldEN1cnJlbnRVc2VyIiwiZmxhZ3MiLCJEZXZlbG9wZXJFeHBlcmltZW50U3RvcmUiLCJ1bnBhdGNoQWxsIl0sIm1hcHBpbmdzIjoiQUFBQSxnS0FPYUEsSUFBSSxLQUFKQSxDQUFJLENBVUtDLFVBQVUsS0FBVkEsQ0FBVSxDQXFEaEJDLFFBQVEsS0FBUkEsQ0FBUSxtQkF0RWMsOEJBQWlCLFlBQ2pDLDhCQUFpQixZQUNqQixpQ0FBWSxZQUNYLDZCQUFVLEVBRTNCQyxDQUFPLENBQUdDLEdBQUFBLENBQU0sT0FBQSxFQUFDLHFCQUFxQixDQUFDLENBRWhDSixDQUFJLENBQUcsQ0FDakJLLElBQUksQ0FBRSxhQUFhLENBQ25CQyxFQUFFLENBQUUsaUJBQWlCLENBQ3JCQyxPQUFPLENBQUUsQ0FBQSxDQUFLLENBQ2RDLE9BQU8sQ0FBRSxDQUFBLENBQUksQ0FDYkMsSUFBSSxDQUFFLENBQUEsQ0FBSyxDQUVYQyxTQUFTLENBQUUsQ0FBQSxDQUFLLENBQ2xCLEFBRU0sZ0JBQWVULENBQVUsRUFBRyxDQUNoQ0QsQ0FBSSxDQUFDVSxTQUFTLENBQUcsQ0FBQSxDQUFLLEFBR3RCLEtBQU1DLENBQU0sQ0FBR0MsQ0FBVSxXQUFBLENBQUNDLHNCQUFzQixBQUFDLEFBQ2pELE1BQU8sQ0FBQ0YsQ0FBTSxDQUFDRyxlQUFlLEVBQUUsTUFBTUMsR0FBQUEsQ0FBSyxNQUFBLEVBQUMsRUFBRSxDQUFDLEFBQUMsQUFHaEQsSUFBSWYsQ0FBSSxDQUFDVSxTQUFTLENBQUUsTUFBTyxBQUczQixLQUFNTSxDQUFRLENBQUdMLENBQU0sQ0FBQyxlQUFpQixBQUFDLENBR3BDTSxDQUFPLENBQUdkLENBQU8sQ0FBQ2UsS0FBSyxDQUFDQyxDQUFLLE1BQUEsQ0FBRSxnQkFBZ0IsQ0FBRSxDQUFDQyxDQUFDLENBQUVDLENBQUUsQ0FBRUMsQ0FBRyxHQUFLLENBQ3BFLEdBQUtBLENBQUcsQ0FFUixPQUFPLElBQUlDLEtBQUssQ0FBQyxFQUFFLENBQUUsQ0FDbEJDLEdBQUcsQ0FBQ0osQ0FBQyxDQUFFSyxDQUFJLENBQUUsT0FDVixBQUFJQSxBQUFTLFNBQVMsR0FEbEJBLENBQUksQUFDYyxDQUNaLFNBQVVDLENBQUksQ0FBRSxRQUNwQixBQURjQSxDQUFJLEdBQ0xDLENBQVMsVUFBQSxDQUFDQyxTQUFTLENBQUNDLEtBQUssRUFJL0JQLENBQUcsQ0FBQ1EsT0FBTyxDQUFDQyxJQUFJLENBQUMsSUFBSSxDQUxkTCxDQUFJLENBS2lCLEFBRmxDLENBR0gsQ0FHR0osQ0FBRyxDQVhORyxDQUFJLENBV1EsQUFGZixDQUdILENBQ0gsQ0FBQyxBQUFDLEFBaEJjLENBaUJuQixDQUFDLENBR0lPLENBQWUsQ0FBR2hCLENBQVEsQ0FBQ2lCLElBQUksQ0FBQ0MsQ0FBQyxFQUFJQSxBQUFXLGlCQUFpQixHQUE1QkEsQ0FBQyxDQUFDN0IsSUFBSSxBQUFzQixDQUFDLEFBeEI3QixDQXlCdkMyQixDQUFlLEVBQUVBLENBQWUsQ0FBQ0csYUFBYSxDQUFDLENBQ2hEQyxJQUFJLENBQUUsaUJBQWlCLENBQ3ZCQyxnQkFBZ0IsQ0FBRSxFQUFFLENBQ3BCQyxXQUFXLENBQUUsRUFBRSxDQUNmQyxJQUFJLENBQUUsQ0FDSCxHQUFHcEIsQ0FBSyxNQUFBLENBQUNxQixjQUFjLEVBQUUsQ0FDekJDLEtBQUssQ0FBRSxDQUFDLENBQ1YsQ0FDSCxDQUFDLEFBR0YsS0FBTUMsQ0FBd0IsQ0FBRzFCLENBQVEsQ0FBQ2lCLElBQUksQ0FBQ0MsQ0FBQyxFQUFJQSxBQUFXLDBCQUEwQixHQUFyQ0EsQ0FBQyxDQUFDN0IsSUFBSSxBQUErQixDQUFDLEFBQUMsQ0FDdkZxQyxDQUF3QixFQUFFQSxDQUF3QixDQUFDUCxhQUFhLEVBQUUsQ0FFdEVsQixDQUFPLEVBQUUsQ0FDWCxBQUVNLFNBQVNmLENBQVEsRUFBRyxDQUN4QkYsQ0FBSSxDQUFDVSxTQUFTLENBQUcsQ0FBQSxDQUFJLENBQ3JCUCxDQUFPLENBQUN3QyxVQUFVLEVBQUUsQ0FDdEIifQ==