"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(exports,{initialize:()=>l,shutdown:()=>m,start:()=>n,stop:()=>o});const a=require("../../api/modals"),b=require("../../../common/logger"),c=h(require("../../../common/settings")),d=require("../../modules/webpack/common"),e=h(require("./registry")),f=require("../../../common/utilities/index");function g(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(g=function(a){return a?c:b})(a)}function h(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=g(b);if(c&&c.has(a))return c.get(a);var d={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!==f&&Object.prototype.hasOwnProperty.call(a,f)){var h=e?Object.getOwnPropertyDescriptor(a,f):null;h&&(h.get||h.set)?Object.defineProperty(d,f,h):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}const i=(0,b.createLogger)("Built-In"),j=(0,f.debounce)(p,250),k={};async function l(){c.on("change",j);let a=Object.keys(e);for(let b=0;b<a.length;b++){let d=a[b];await n(d)}}async function m(){c.off("change",j);let a=Object.keys(e);for(let b=0;b<a.length;b++){let d=a[b];await o(d)}}async function n(a){let b=e[a];if(c.get("unbound",b.data.id,b.data.default)&& !k[b.data.id]&&b)try{b.data.wait?await b.initialize():b.initialize(),k[b.data.id]=!0,i.log(`${b.data.name} was initialized.`)}catch(d){i.error(`Failed to start ${b.data.name}.`,d.message)}}async function o(a){let b=e[a];if(k[b.data.id]&&b)try{b.data.wait?await b.shutdown():b.shutdown(),delete k[b.data.id],i.log(`${b.data.name} was stopped.`)}catch(c){i.error(`Failed to stop ${b.data.name}.`,c.message)}}async function p({key:b,value:c}){let f=Object.entries(e).find(([,a])=>a.data.id===b);if(!f)return;let[g,h]=f;if(h.data.restart)return(0,a.showConfirmModal)({header:d.Locale.Messages.UNBOUND_RESTART,content:d.Locale.Messages.UNBOUND_RESTART_SETTING_DESC,confirmText:d.Locale.Messages.UNBOUND_RESTART,cancelText:d.Locale.Messages.CANCEL,onConfirm:()=>window.location.reload()});c?await n(g):await o(g)}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jbGllbnQvY29yZS9idWlsdGlucy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzaG93Q29uZmlybU1vZGFsIH0gZnJvbSAnQGFwaS9tb2RhbHMnO1xyXG5pbXBvcnQgeyBjcmVhdGVMb2dnZXIgfSBmcm9tICdAY29tbW9uL2xvZ2dlcic7XHJcbmltcG9ydCAqIGFzIFNldHRpbmdzIGZyb20gJ0Bjb21tb24vc2V0dGluZ3MnO1xyXG5pbXBvcnQgeyBMb2NhbGUgfSBmcm9tICdAd2VicGFjay9jb21tb24nO1xyXG5pbXBvcnQgKiBhcyBCdWlsdElucyBmcm9tICcuL3JlZ2lzdHJ5JztcclxuaW1wb3J0IHsgZGVib3VuY2UgfSBmcm9tICdAdXRpbGl0aWVzJztcclxuXHJcbmNvbnN0IExvZ2dlciA9IGNyZWF0ZUxvZ2dlcignQnVpbHQtSW4nKTtcclxuXHJcbmNvbnN0IGhhbmRsZVNldHRpbmdzQ2hhbmdlID0gZGVib3VuY2Uob25TZXR0aW5nc0NoYW5nZSwgMjUwKTtcclxuXHJcbmludGVyZmFjZSBTZXR0aW5nc0NoYW5nZSB7XHJcbiAgIGtleTogc3RyaW5nO1xyXG4gICB2YWx1ZTogYm9vbGVhbjtcclxufVxyXG5cclxuaW50ZXJmYWNlIEJ1aWx0SW5EYXRhIHtcclxuICAgcmVzdGFydD86IGJvb2xlYW47XHJcbiAgIGRlZmF1bHQ6IGJvb2xlYW47XHJcbiAgIHdhaXQ/OiBib29sZWFuO1xyXG4gICBuYW1lOiBzdHJpbmcsXHJcbiAgIGlkOiBzdHJpbmcsXHJcbn1cclxuXHJcbmludGVyZmFjZSBJbnN0YW5jZSBleHRlbmRzIEJ1aWx0SW5EYXRhIHtcclxuICAgaW5pdGlhbGl6ZTogRm47XHJcbiAgIHNodXRkb3duOiBGbjtcclxuICAgW2tleTogc3RyaW5nXTogYW55O1xyXG59XHJcblxyXG5jb25zdCBzdGFydGVkOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPiA9IHt9O1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRpYWxpemUoKSB7XHJcbiAgIFNldHRpbmdzLm9uKCdjaGFuZ2UnLCBoYW5kbGVTZXR0aW5nc0NoYW5nZSk7XHJcblxyXG4gICBjb25zdCBidWlsdGlucyA9IE9iamVjdC5rZXlzKEJ1aWx0SW5zKTtcclxuICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWlsdGlucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBuYW1lID0gYnVpbHRpbnNbaV07XHJcbiAgICAgIGF3YWl0IHN0YXJ0KG5hbWUpO1xyXG4gICB9XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzaHV0ZG93bigpIHtcclxuICAgU2V0dGluZ3Mub2ZmKCdjaGFuZ2UnLCBoYW5kbGVTZXR0aW5nc0NoYW5nZSk7XHJcblxyXG4gICBjb25zdCBidWlsdGlucyA9IE9iamVjdC5rZXlzKEJ1aWx0SW5zKTtcclxuICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWlsdGlucy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBuYW1lID0gYnVpbHRpbnNbaV07XHJcbiAgICAgIGF3YWl0IHN0b3AobmFtZSk7XHJcbiAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0YXJ0KG5hbWU6IHN0cmluZykge1xyXG4gICBjb25zdCBpbnN0YW5jZSA9IEJ1aWx0SW5zW25hbWVdO1xyXG5cclxuICAgaWYgKCFTZXR0aW5ncy5nZXQoJ3VuYm91bmQnLCBpbnN0YW5jZS5kYXRhLmlkLCBpbnN0YW5jZS5kYXRhLmRlZmF1bHQpKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG5cclxuICAgaWYgKHN0YXJ0ZWRbaW5zdGFuY2UuZGF0YS5pZF0gfHwgIWluc3RhbmNlKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG5cclxuICAgdHJ5IHtcclxuICAgICAgaWYgKGluc3RhbmNlLmRhdGEud2FpdCkge1xyXG4gICAgICAgICBhd2FpdCBpbnN0YW5jZS5pbml0aWFsaXplKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgIGluc3RhbmNlLmluaXRpYWxpemUoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgc3RhcnRlZFtpbnN0YW5jZS5kYXRhLmlkXSA9IHRydWU7XHJcbiAgICAgIExvZ2dlci5sb2coYCR7aW5zdGFuY2UuZGF0YS5uYW1lfSB3YXMgaW5pdGlhbGl6ZWQuYCk7XHJcbiAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgTG9nZ2VyLmVycm9yKGBGYWlsZWQgdG8gc3RhcnQgJHtpbnN0YW5jZS5kYXRhLm5hbWV9LmAsIGUubWVzc2FnZSk7XHJcbiAgIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHN0b3AobmFtZTogc3RyaW5nKSB7XHJcbiAgIGNvbnN0IGluc3RhbmNlID0gQnVpbHRJbnNbbmFtZV07XHJcblxyXG4gICBpZiAoIXN0YXJ0ZWRbaW5zdGFuY2UuZGF0YS5pZF0gfHwgIWluc3RhbmNlKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgfVxyXG5cclxuICAgdHJ5IHtcclxuICAgICAgaWYgKGluc3RhbmNlLmRhdGEud2FpdCkge1xyXG4gICAgICAgICBhd2FpdCBpbnN0YW5jZS5zaHV0ZG93bigpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgICBpbnN0YW5jZS5zaHV0ZG93bigpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBkZWxldGUgc3RhcnRlZFtpbnN0YW5jZS5kYXRhLmlkXTtcclxuICAgICAgTG9nZ2VyLmxvZyhgJHtpbnN0YW5jZS5kYXRhLm5hbWV9IHdhcyBzdG9wcGVkLmApO1xyXG4gICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIExvZ2dlci5lcnJvcihgRmFpbGVkIHRvIHN0b3AgJHtpbnN0YW5jZS5kYXRhLm5hbWV9LmAsIGUubWVzc2FnZSk7XHJcbiAgIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gb25TZXR0aW5nc0NoYW5nZSh7IGtleSwgdmFsdWUgfTogU2V0dGluZ3NDaGFuZ2UpIHtcclxuICAgY29uc3QgcGF5bG9hZCA9IE9iamVjdC5lbnRyaWVzKEJ1aWx0SW5zKS5maW5kKChbLCB2XSkgPT4gdi5kYXRhLmlkID09PSBrZXkpO1xyXG4gICBpZiAoIXBheWxvYWQpIHJldHVybjtcclxuXHJcbiAgIGNvbnN0IFtidWlsdGluLCBpbnN0YW5jZV0gPSBwYXlsb2FkIGFzIHVua25vd24gYXMgW3N0cmluZywgSW5zdGFuY2VdO1xyXG5cclxuICAgaWYgKGluc3RhbmNlLmRhdGEucmVzdGFydCkge1xyXG4gICAgICByZXR1cm4gc2hvd0NvbmZpcm1Nb2RhbCh7XHJcbiAgICAgICAgIGhlYWRlcjogTG9jYWxlLk1lc3NhZ2VzLlVOQk9VTkRfUkVTVEFSVCxcclxuICAgICAgICAgY29udGVudDogTG9jYWxlLk1lc3NhZ2VzLlVOQk9VTkRfUkVTVEFSVF9TRVRUSU5HX0RFU0MsXHJcbiAgICAgICAgIGNvbmZpcm1UZXh0OiBMb2NhbGUuTWVzc2FnZXMuVU5CT1VORF9SRVNUQVJULFxyXG4gICAgICAgICBjYW5jZWxUZXh0OiBMb2NhbGUuTWVzc2FnZXMuQ0FOQ0VMLFxyXG4gICAgICAgICBvbkNvbmZpcm06ICgpID0+IHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKVxyXG4gICAgICB9KTtcclxuICAgfTtcclxuXHJcbiAgIGlmICghdmFsdWUpIHtcclxuICAgICAgYXdhaXQgc3RvcChidWlsdGluKTtcclxuICAgfSBlbHNlIHtcclxuICAgICAgYXdhaXQgc3RhcnQoYnVpbHRpbik7XHJcbiAgIH1cclxufSJdLCJuYW1lcyI6WyJpbml0aWFsaXplIiwic2h1dGRvd24iLCJzdGFydCIsInN0b3AiLCJMb2dnZXIiLCJjcmVhdGVMb2dnZXIiLCJoYW5kbGVTZXR0aW5nc0NoYW5nZSIsImRlYm91bmNlIiwib25TZXR0aW5nc0NoYW5nZSIsInN0YXJ0ZWQiLCJTZXR0aW5ncyIsIm9uIiwiYnVpbHRpbnMiLCJPYmplY3QiLCJrZXlzIiwiQnVpbHRJbnMiLCJpIiwibGVuZ3RoIiwibmFtZSIsIm9mZiIsImluc3RhbmNlIiwiZ2V0IiwiZGF0YSIsImlkIiwiZGVmYXVsdCIsIndhaXQiLCJsb2ciLCJlIiwiZXJyb3IiLCJtZXNzYWdlIiwia2V5IiwidmFsdWUiLCJwYXlsb2FkIiwiZW50cmllcyIsImZpbmQiLCJ2IiwiYnVpbHRpbiIsInJlc3RhcnQiLCJzaG93Q29uZmlybU1vZGFsIiwiaGVhZGVyIiwiTG9jYWxlIiwiTWVzc2FnZXMiLCJVTkJPVU5EX1JFU1RBUlQiLCJjb250ZW50IiwiVU5CT1VORF9SRVNUQVJUX1NFVFRJTkdfREVTQyIsImNvbmZpcm1UZXh0IiwiY2FuY2VsVGV4dCIsIkNBTkNFTCIsIm9uQ29uZmlybSIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVsb2FkIl0sIm1hcHBpbmdzIjoiQUFBQSxnS0FnQ3NCQSxVQUFVLEtBQVZBLENBQVUsQ0FVVkMsUUFBUSxLQUFSQSxDQUFRLENBVVJDLEtBQUssS0FBTEEsQ0FBSyxDQXlCTEMsSUFBSSxLQUFKQSxDQUFJLG1CQTdFTyxrQkFBYSxZQUNqQix3QkFBZ0IsY0FDbkIsMEJBQWtCLGFBQ3JCLDhCQUFpQixjQUNkLFlBQVksYUFDYixpQ0FBWSwrakJBRXJDLE1BQU1DLENBQU0sQ0FBR0MsR0FBQUEsQ0FBWSxhQUFBLEVBQUMsVUFBVSxDQUFDLENBRWpDQyxDQUFvQixDQUFHQyxHQUFBQSxDQUFRLFNBQUEsRUFBQ0MsQ0FBZ0IsQ0FBRSxHQUFHLENBQUMsQ0FxQnREQyxDQUFPLENBQTRCLEVBQUUsQUF2QkgsQUF5QmpDLGdCQUFlVCxDQUFVLEVBQUcsQ0FDaENVLENBQVEsQ0FBQ0MsRUFBRSxDQUFDLFFBQVEsQ0FBRUwsQ0FBb0IsQ0FBQyxBQUUzQyxLQUFNTSxDQUFRLENBQUdDLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDQyxDQUFRLENBQUMsQUFBQyxBQUN2QyxLQUFLLElBQUlDLENBQUMsQ0FBRyxDQUFDLENBQUVBLENBQUMsQ0FBR0osQ0FBUSxDQUFDSyxNQUFNLENBQUVELENBQUMsRUFBRSxDQUFFLENBQ3ZDLElBQU1FLENBQUksQ0FBR04sQ0FBUSxDQUFDSSxDQUFDLENB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