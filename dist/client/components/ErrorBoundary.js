"use strict";const a=require("./discord"),b=require("../modules/webpack/index"),c=require("../../common/constants"),d=_interopRequireDefault(require("../modules/react")),e=_interopRequireDefault(require("../styles/components/errorboundary.css"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}e.default.append(),(0,b.findByDisplayName)("IntegrationInfo");class ErrorBoundary extends d.default.PureComponent{constructor(a){super(a),this.state={error:!1}}componentDidCatch(a,{componentStack:b}){let c=`${a.name?`${a.name}: `:""}${a.message}`,d=this.cleanError(a.stack,c),e=this.cleanError(b);this.setState({error:!0,component:e,js:d})}cleanError(a,b){let clean=a=>Boolean(a)&&!a.includes("/assets"),d=a.split(c.Regex.newline);if(b){let e=d.findIndex(a=>a===b);null!==e&&d.splice(e,1)}return{stack:d.filter(clean).join("\n").replace(/    /g,""),message:b}}render(){if(this.state.error){let b=this.props.fallback;if(b)return d.default.createElement(b,Object.assign({},this.state));let c={name:"JavaScript Error",description:"Runtime error provided by JavaScript.",icon:"Close",state:"js"},e={name:"Component Lifecycle",description:"Lifecycle error provided by React.",icon:"Synced",state:"component"};return d.default.createElement("div",{className:"unbound-boundary-wrapper"},d.default.createElement("img",{src:"/assets/b5eb2f7d6b3f8cc9b60be4a5dcf28015.svg",className:"unbound-boundary-sad-wumpus"}),d.default.createElement(a.Text,{color:a.Text.Colors.MUTED,size:a.Text.Sizes.SIZE_16,className:"unbound-boundary-notice"},"Oops, we couldn't render this."),this.renderStack(c),this.renderStack(e))}return this.props.children}renderStack({state:a}){let b=this.state[a];return b?d.default.createElement("div",{className:"unbound-boundary-integration-card"},b.message&&d.default.createElement("div",{className:"unbound-boundary-error-wrapper"},b.message),b.stack&&d.default.createElement("div",{className:"unbound-boundary-error-wrapper"},b.stack)):null}}module.exports=ErrorBoundary